<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Wordiness - Parts of Speech Spotlight</title>
<style>
:root{
  --bg:#070b12; --card: rgba(255,255,255,.06); --text:#e9eefb; --muted: rgba(233,238,251,.72);
  --line: rgba(255,255,255,.12); --accent:#5ee7ff; --good:#35d07f; --bad:#ff5d7a;
  --shadow: 0 18px 60px rgba(0,0,0,.55); --r: 18px; --pad: 18px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  background:
    radial-gradient(1000px 700px at 15% 10%, rgba(94,231,255,.18), transparent 55%),
    radial-gradient(900px 650px at 85% 30%, rgba(53,208,127,.16), transparent 55%),
    radial-gradient(900px 700px at 60% 100%, rgba(255,93,122,.10), transparent 55%),
    var(--bg);
  color:var(--text);
}
.wrap{max-width:1100px;margin:0 auto;padding:20px 14px 44px}
.top{display:flex;align-items:center;gap:12px;justify-content:space-between;margin-bottom:14px;flex-wrap:wrap}
.brand{display:flex;align-items:center;gap:10px;min-width:0}
.brand img{width:34px;height:34px;border-radius:10px;object-fit:cover;box-shadow:0 6px 22px rgba(0,0,0,.35);border:1px solid rgba(255,255,255,.18)}
.h1{font-size:20px;font-weight:900;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.sub{font-size:13px;color:var(--muted);margin-top:2px}
.pillrow{display:flex;gap:8px;flex-wrap:wrap}
.pill, button, select, input[type="range"]{
  border:1px solid var(--line);
  background: rgba(255,255,255,.05);
  color:var(--text);
  border-radius:999px;
  padding:10px 12px;
  font-size:14px;
}
select{padding:10px 12px}
button{cursor:pointer}
button.primary{
  background: linear-gradient(180deg, rgba(94,231,255,.18), rgba(94,231,255,.08));
  border-color: rgba(94,231,255,.35);
  box-shadow: 0 12px 30px rgba(0,0,0,.35);
  font-weight:800;
}
.card{
  background: var(--card);
  border:1px solid var(--line);
  border-radius: var(--r);
  box-shadow: var(--shadow);
  overflow:hidden;
}
.card .hd{
  padding: var(--pad);
  display:flex; align-items:flex-start; justify-content:space-between; gap:12px;
  border-bottom:1px solid rgba(255,255,255,.10);
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
}
.card .bd{padding: var(--pad)}
.title{font-weight:900;font-size:15px}
.hint{color:var(--muted);font-size:13px;margin-top:6px;line-height:1.35}
.bigGoal{font-size:18px;font-weight:950;letter-spacing:.2px;margin-top:6px}
.kpi{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end}
.chip{padding:8px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background: rgba(0,0,0,.18);font-size:13px}
.grid{display:grid;grid-template-columns:1.1fr .9fr;gap:14px}
@media (max-width: 900px){ .grid{grid-template-columns:1fr} }
.hr{height:1px;background:rgba(255,255,255,.10);margin:12px 0}
.tilewrap{display:flex;flex-wrap:wrap;gap:10px}
.tile{
  user-select:none;
  padding:12px 14px;
  border-radius: 14px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  min-height:44px;
  display:flex; align-items:center; justify-content:center;
  font-weight:800;
}
.tile:active{transform:scale(.99)}
.tile.good{outline:2px solid rgba(53,208,127,.55)}
.tile.bad{outline:2px solid rgba(255,93,122,.55)}
.slotrow{display:flex;gap:10px;flex-wrap:wrap;min-height:56px;align-items:center}
.slot{
  border:1px dashed rgba(255,255,255,.18);
  background: rgba(0,0,0,.14);
  border-radius: 14px;
  padding:12px 12px;
  min-height:52px;
  min-width:120px;
  display:flex; align-items:center; justify-content:center;
  color: rgba(233,238,251,.55);
  font-weight:800;
}
.slot.filled{border-style:solid;color:var(--text)}
.toast{
  position:fixed;left:50%;transform:translateX(-50%);
  bottom:18px;max-width:92vw;
  background: rgba(0,0,0,.72);
  border:1px solid rgba(255,255,255,.18);
  padding:12px 14px;border-radius:14px;
  box-shadow: 0 18px 50px rgba(0,0,0,.55);
  font-size:14px;color: var(--text);
  display:none;
}
.toast.show{display:block;animation:pop .18s ease-out}
@keyframes pop{from{transform:translateX(-50%) translateY(6px);opacity:0}to{transform:translateX(-50%) translateY(0);opacity:1}}
.small{font-size:12px;color:var(--muted)}
</style>
</head>
<body>
<div class="wrap">
  <div class="top">
    <div class="brand">
      <img src="crest.png" onerror="this.onerror=null; this.src='kns-crest.jpg';">
      <div>
        <div class="h1">Wordiness - Parts of Speech Spotlight</div>
        <div class="sub">Find verbs, nouns, adjectives, adverbs (tap-to-select).</div>
      </div>
    </div>
    <div class="pillrow">
      <span class="pill">Mode</span>
      <button class="pill" id="modeStd" type="button">Standard</button>
      <button class="pill" id="modeSup" type="button">Supported</button>
      <button class="pill" id="ttsBtn" type="button">TTS: On</button>
      <button class="pill" id="slowBtn" type="button">Voice: Normal</button>
      <select class="pill" id="voiceSel" aria-label="Voice"><option>Loading voices...</option></select>
      <button class="pill" id="stopBtn" type="button">Stop</button>
    </div>
  </div>

<div class="grid">
  <div class="card">
    <div class="hd">
      <div>
        <div class="title">Goal</div>
        <div class="hint">Tap the words that match the target (verbs/nouns/adjectives/adverbs). Press <b>Check</b>.</div>
        <div class="bigGoal" id="goalText">Press Start.</div>
      </div>
      <div class="kpi">
        <div class="chip">Score <b id="score">0</b></div>
        <div class="chip">Round <b id="round">0</b></div>
      </div>
    </div>
    <div class="bd">
      <div class="pillrow">
        <button class="primary" id="startBtn" type="button">Start</button>
        <button id="checkBtn" type="button">Check</button>
        <button id="sayBtn" type="button">Hear</button>
        <button id="newBtn" type="button">New sentence</button>
      </div>
      <div class="small" id="hintBox" style="margin-top:10px"></div>
      <div class="hr"></div>
      <div class="tilewrap" id="words"></div>
    </div>
  </div>

  <div class="card">
    <div class="hd">
      <div>
        <div class="title">Support tools</div>
        <div class="hint">Spacing helps visual tracking (great on tablets).</div>
      </div>
      <div class="kpi"><div class="chip">Tweak</div></div>
    </div>
    <div class="bd">
      <div class="small">Font size</div>
      <input type="range" id="fs" min="14" max="26" value="18" style="width:100%">
      <div class="hr"></div>
      <div class="small">Word spacing</div>
      <input type="range" id="ws" min="6" max="22" value="10" style="width:100%">
      <div class="hr"></div>
      <div class="small">Supported mode: fewer distractors + a hint.</div>
    </div>
  </div>
</div>
</div>

<div class="toast" id="toast" role="status" aria-live="polite"></div>

<script>
(function(){
  const state = {
    tts: true, voice: null, voices: [], preferSlow: false,
    mode: (localStorage.getItem("wordiness_mode") || "supported")
  };

  function qs(sel, el){ return (el||document).querySelector(sel); }
  function qsa(sel, el){ return Array.from((el||document).querySelectorAll(sel)); }

  function toast(msg, kind){
    const t = qs("#toast"); if(!t) return;
    t.textContent = msg;
    t.style.borderColor = kind==="good" ? "rgba(53,208,127,.45)" : kind==="bad" ? "rgba(255,93,122,.45)" : "rgba(255,255,255,.18)";
    t.classList.add("show");
    clearTimeout(toast._to);
    toast._to = setTimeout(()=>t.classList.remove("show"), 1600);
  }

  function escapeHtml(s){
    return String(s||"").replace(/[&<>"']/g, c=>({ "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;" }[c]));
  }

  function loadVoices(){
    if(!("speechSynthesis" in window)) return;
    const all = speechSynthesis.getVoices() || [];
    state.voices = all;
    const sel = qs("#voiceSel");
    if(!sel) return;
    const prev = localStorage.getItem("wordiness_voice") || "";
    sel.innerHTML = '<option value="">Default voice</option>' + all.map(v=>`<option value="${escapeHtml(v.name)}">${escapeHtml(v.name)} (${v.lang})</option>`).join("");
    sel.value = all.some(v=>v.name===prev) ? prev : "";
    state.voice = sel.value ? (all.find(v=>v.name===sel.value) || null) : null;
  }

  function speak(text, opts){
    try{
      if(!state.tts) return;
      if(!("speechSynthesis" in window)) return;
      const u = new SpeechSynthesisUtterance(String(text||""));
      u.rate = (opts && opts.slow) ? 0.82 : 1.0;
      if(state.voice) u.voice = state.voice;
      speechSynthesis.cancel();
      setTimeout(()=>speechSynthesis.speak(u), 40);
    }catch(e){}
  }
  function stopSpeak(){ try{ if("speechSynthesis" in window) speechSynthesis.cancel(); }catch(e){} }

  function setMode(m){
    state.mode = m;
    localStorage.setItem("wordiness_mode", m);
    document.documentElement.dataset.mode = m;
  }

  function initTopbar(){
    setMode(state.mode);

    const mStd = qs("#modeStd"), mSup = qs("#modeSup");
    if(mStd) mStd.onclick = ()=>setMode("standard");
    if(mSup) mSup.onclick = ()=>setMode("supported");

    const ttsBtn = qs("#ttsBtn");
    if(ttsBtn){
      const saved = localStorage.getItem("wordiness_tts");
      state.tts = saved ? (saved==="1") : true;
      ttsBtn.textContent = "TTS: " + (state.tts ? "On" : "Off");
      ttsBtn.onclick = ()=>{
        state.tts = !state.tts;
        localStorage.setItem("wordiness_tts", state.tts ? "1" : "0");
        ttsBtn.textContent = "TTS: " + (state.tts ? "On" : "Off");
        toast(state.tts ? "Text-to-speech on" : "Text-to-speech off");
      };
    }

    const slowBtn = qs("#slowBtn");
    if(slowBtn){
      const saved2 = localStorage.getItem("wordiness_slow");
      state.preferSlow = saved2 ? (saved2==="1") : false;
      slowBtn.textContent = state.preferSlow ? "Voice: Slow" : "Voice: Normal";
      slowBtn.onclick = ()=>{
        state.preferSlow = !state.preferSlow;
        localStorage.setItem("wordiness_slow", state.preferSlow ? "1" : "0");
        slowBtn.textContent = state.preferSlow ? "Voice: Slow" : "Voice: Normal";
        toast(state.preferSlow ? "Slower voice" : "Normal voice");
      };
    }

    const stopBtn = qs("#stopBtn");
    if(stopBtn) stopBtn.onclick = ()=>{ stopSpeak(); toast("Stopped"); };

    const sel = qs("#voiceSel");
    if(sel){
      sel.onchange = ()=>{
        const name = sel.value || "";
        localStorage.setItem("wordiness_voice", name);
        state.voice = name ? (state.voices.find(v=>v.name===name) || null) : null;
        toast(name ? "Voice set" : "Default voice");
      };
    }

    loadVoices();
    if("speechSynthesis" in window){
      speechSynthesis.onvoiceschanged = loadVoices;
      setTimeout(loadVoices, 250);
    }
  }

  window.__WORDINESS__ = { qs, qsa, toast, speak, stopSpeak, state, escapeHtml, initTopbar };
})();
</script>
<script>
window.__WORDINESS__.initTopbar();
(function(){
  const {qs, toast, speak, state} = window.__WORDINESS__;

  const SENTENCES = [
    {w:[
      {t:"The", p:"det"},{t:"curious", p:"adj"},{t:"child", p:"noun"},{t:"found", p:"verb"},{t:"a", p:"det"},{t:"tiny", p:"adj"},{t:"shell", p:"noun"},{t:"outside", p:"adv"}
    ], hint:"Verb = action word (found)"},
    {w:[
      {t:"We", p:"pron"},{t:"quickly", p:"adv"},{t:"packed", p:"verb"},{t:"our", p:"det"},{t:"bags", p:"noun"},{t:"because", p:"conj"},{t:"it", p:"pron"},{t:"was", p:"verb"},{t:"late", p:"adj"}
    ], hint:"Adverbs often end -ly (quickly)"},
    {w:[
      {t:"My", p:"det"},{t:"friend", p:"noun"},{t:"can", p:"verb"},{t:"carefully", p:"adv"},{t:"build", p:"verb"},{t:"a", p:"det"},{t:"model", p:"noun"}
    ], hint:"Verbs include helper verbs (can)"}
  ];

  const TARGETS = [
    {key:"verb", label:"verbs"},
    {key:"noun", label:"nouns"},
    {key:"adj",  label:"adjectives"},
    {key:"adv",  label:"adverbs"}
  ];

  let idx=0, target=null, score=0, round=0, started=false;
  let picks = new Set();

  const elGoal=qs("#goalText");
  const elWords=qs("#words");
  const elScore=qs("#score");
  const elRound=qs("#round");
  const elHint=qs("#hintBox");

  function pickRound(){
    idx = Math.floor(Math.random()*SENTENCES.length);
    target = TARGETS[Math.floor(Math.random()*TARGETS.length)];
    picks.clear();
    render();
    speak("Find " + target.label, {slow:true});
  }

  function currentWords(){
    const s = SENTENCES[idx];
    if(state.mode==="standard") return s.w;
    return s.w.filter(w=>w.p===target.key || w.p==="det" || w.p==="pron" || w.p==="conj");
  }

  function render(){
    const s = SENTENCES[idx];
    elGoal.textContent = "Find: " + (target ? target.label : "...");
    elHint.textContent = (state.mode==="supported" && s.hint) ? ("Hint: " + s.hint) : "";
    elScore.textContent=String(score);
    elRound.textContent=String(round);

    elWords.style.gap = (qs("#ws").value||10) + "px";
    elWords.style.fontSize = (qs("#fs").value||18) + "px";

    const words = currentWords();
    elWords.innerHTML="";
    words.forEach((w, i)=>{
      const b=document.createElement("button");
      b.type="button";
      b.className="tile" + (picks.has(i) ? " good" : "");
      b.textContent=w.t;
      b.onclick = ()=>{
        if(picks.has(i)) picks.delete(i); else picks.add(i);
        render();
        speak(w.t, {slow: state.preferSlow});
      };
      elWords.appendChild(b);
    });
  }

  function check(){
    if(!started){ toast("Press Start"); return; }
    const words = currentWords();
    let correct=0, wrong=0;
    words.forEach((w,i)=>{
      const picked = picks.has(i);
      if(picked && w.p===target.key) correct++;
      if(picked && w.p!==target.key) wrong++;
    });
    const totalTarget = words.filter(w=>w.p===target.key).length;

    if(correct===totalTarget && wrong===0){
      score += 10; round += 1;
      toast("Perfect!", "good");
      speak("Perfect", {slow: state.preferSlow});
      pickRound();
    } else {
      score = Math.max(0, score-1);
      toast("Got " + correct + "/" + totalTarget + ". Try again.", "bad");
      speak("Try again", {slow:true});
      Array.from(elWords.children).forEach((el,i)=>{
        const w=words[i];
        if(picks.has(i) && w.p!==target.key){ el.classList.add("bad"); setTimeout(()=>el.classList.remove("bad"), 650); }
      });
      elScore.textContent=String(score);
    }
    elRound.textContent=String(round);
  }

  function say(){
    const s=SENTENCES[idx];
    const txt = s.w.map(w=>w.t).join(" ").replace(/\s+/g," ").trim();
    speak(txt, {slow: state.preferSlow});
  }

  qs("#startBtn").onclick = ()=>{ started=true; score=0; round=0; pickRound(); toast("Started","good"); };
  qs("#checkBtn").onclick = check;
  qs("#newBtn").onclick   = ()=>{ if(!started){toast("Press Start"); return;} pickRound(); };
  qs("#sayBtn").onclick   = say;

  qs("#fs").oninput = render;
  qs("#ws").oninput = render;

  render();
})();
</script>

<!-- wordiness-seed-bridge-v1 -->
<script src="wordiness-seed-bridge.js"></script>
</body>
</html>